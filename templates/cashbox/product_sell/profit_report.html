{% extends "admin/base_site.html" %}
{% load i18n admin_static %}

{% block breadcrumbs %}
<div class="breadcrumbs">
<a href="{% url 'admin:index' %}">{% trans 'Home' %}</a>
&rsaquo; <a href="{% url 'admin:app_list' app_label='cashbox' %}">Касса</a>
&rsaquo; <a href="/admin/cashbox/productsell/">Продажи</a>
&rsaquo; {{ 'Отчет по прибыли с продаж' }}
</div>
{% endblock %}

{% block content %}
    <span>Фильтр</span>
    <ul>
        <li><a href="{% url 'product_sell_report_profit_view' %}?period_type=day">За текущий день</a></li>
        <li><a href="{% url 'product_sell_report_profit_view' %}?period_type=month">За текущий месяц</a></li>
        <li>
            <form action="{% url 'product_sell_report_profit_view' %}" id="form_period" method="get">
                <span>За период с </span><input name="period_start" type="date" required pattern="\d{1,2}.\d{1,2}.\d{4}"/>
                по <input name="period_end" type="date" required pattern="\d{1,2}.\d{1,2}.\d{4}"/>
                <input hidden name="period_type" value="period">
                <input type="submit">
            </form>
        </li>
    </ul>
    </h1>
    <h1>{{ report }}</h1>
    <table>
        <thead>
            <th>№</th>
            <th>Вид</th>
            <th>Продаж с этим видом</th>
            <th>Количество в продажах</th>
            <th>Общая сумма продаж(руб.)</th>
            <th>Общая сумма по себестоимости(руб.)</th>
            <th>Прибыль(руб.)</th>
            <th>Средняя цена за 1 шт(руб.)</th>
        </thead>
        <tbody>
            {% for item in report.kinds_aggr %}
            <tr>
                <td>{{ forloop.counter }}</td>
                <td>{{ item.kind_name }}</td>
                <td>{{ item.sell_count }}</td>
                <td>{{ item.count }}</td>
                <td>{{ item.sell_cost|round_number:'2' }}</td>
                <td>{{ item.product_cost|round_number:'2' }}</td>
                <td>{{ item.get_profit_amount|round_number:'2' }}</td>
                <td>{{ item.get_average_sell_cost|round_number:'2' }} руб.</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    <input type="button" value="Назад" onclick="window.location='/admin/cashbox/productsell/';">

{% endblock %}